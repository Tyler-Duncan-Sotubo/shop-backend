import { db as DbType } from 'src/drizzle/types/drizzle';
import { InvoiceTotalsService } from './invoice-totals.service';
import { CreateInvoiceFromOrderDto } from './dto/create-invoice-from-order.dto';
import { IssueInvoiceDto } from './dto/issue-invoice.dto';
import { AuditService } from 'src/modules/audit/audit.service';
import { UpdateInvoiceLineDto } from './dto/update-invoice-line.dto';
import { ListInvoicesQueryDto } from './dto/list-invoices.query.dto';
import { CacheService } from 'src/common/cache/cache.service';
type TxOrDb = DbType | any;
export declare class InvoiceService {
    private readonly db;
    private readonly totals;
    private readonly auditService;
    private readonly cache;
    constructor(db: DbType, totals: InvoiceTotalsService, auditService: AuditService, cache: CacheService);
    createDraftFromOrder(params: CreateInvoiceFromOrderDto, companyId: string, ctx?: {
        tx?: TxOrDb;
    }): Promise<any>;
    recalculateDraftTotals(companyId: string, invoiceId: string, ctx?: {
        tx?: TxOrDb;
    }): Promise<any>;
    issueInvoice(invoiceId: string, dto: IssueInvoiceDto, companyId: string, userId?: string, ctx?: {
        tx?: TxOrDb;
    }): Promise<any>;
    getInvoiceWithLines(companyId: string, invoiceId: string): Promise<{
        invoice: {
            id: string;
            companyId: string;
            storeId: string | null;
            orderId: string | null;
            quoteRequestId: string | null;
            type: "invoice" | "credit_note";
            status: "draft" | "issued" | "partially_paid" | "paid" | "void";
            customerId: string | null;
            billingAddressId: string | null;
            shippingAddressId: string | null;
            customerSnapshot: unknown;
            supplierSnapshot: unknown;
            seriesId: string | null;
            sequenceNumber: number | null;
            number: string | null;
            issuedAt: Date | null;
            dueAt: Date | null;
            currency: string;
            exchangeRate: string | null;
            subtotalMinor: number;
            discountMinor: number;
            shippingMinor: number;
            taxMinor: number;
            adjustmentMinor: number;
            roundingMinor: number;
            totalMinor: number;
            paidMinor: number;
            balanceMinor: number;
            lockedAt: Date | null;
            voidedAt: Date | null;
            voidReason: string | null;
            meta: unknown;
            createdAt: Date;
            updatedAt: Date;
        };
        lines: {
            id: string;
            companyId: string;
            invoiceId: string;
            productId: string | null;
            variantId: string | null;
            orderId: string | null;
            position: number;
            description: string;
            quantity: number;
            unitPriceMinor: number;
            discountMinor: number;
            lineNetMinor: number;
            taxId: string | null;
            taxName: string | null;
            taxRateBps: number;
            taxInclusive: boolean;
            taxExempt: boolean;
            taxExemptReason: string | null;
            taxMinor: number;
            lineTotalMinor: number;
            meta: unknown;
        }[];
    }>;
    listInvoices(companyId: string, opts: ListInvoicesQueryDto): Promise<{
        id: string;
        type: "invoice" | "credit_note";
        number: string | null;
        status: "draft" | "issued" | "partially_paid" | "paid" | "void";
        currency: string;
        subtotalMinor: number;
        taxMinor: number;
        totalMinor: number;
        paidMinor: number;
        balanceMinor: number;
        orderId: string | null;
        storeId: string | null;
        issuedAt: Date | null;
        dueAt: Date | null;
        createdAt: Date;
        updatedAt: Date;
        meta: unknown;
        customerSnapshot: unknown;
    }[]>;
    updateDraftLineAndRecalculate(companyId: string, invoiceId: string, lineId: string, dto: UpdateInvoiceLineDto, audit?: {
        userId?: string;
        ip?: string;
    }): Promise<{
        invoice: {
            id: string;
            companyId: string;
            storeId: string | null;
            orderId: string | null;
            quoteRequestId: string | null;
            type: "invoice" | "credit_note";
            status: "draft" | "issued" | "partially_paid" | "paid" | "void";
            customerId: string | null;
            billingAddressId: string | null;
            shippingAddressId: string | null;
            customerSnapshot: unknown;
            supplierSnapshot: unknown;
            seriesId: string | null;
            sequenceNumber: number | null;
            number: string | null;
            issuedAt: Date | null;
            dueAt: Date | null;
            currency: string;
            exchangeRate: string | null;
            subtotalMinor: number;
            discountMinor: number;
            shippingMinor: number;
            taxMinor: number;
            adjustmentMinor: number;
            roundingMinor: number;
            totalMinor: number;
            paidMinor: number;
            balanceMinor: number;
            lockedAt: Date | null;
            voidedAt: Date | null;
            voidReason: string | null;
            meta: unknown;
            createdAt: Date;
            updatedAt: Date;
        };
        lines: {
            id: string;
            companyId: string;
            invoiceId: string;
            productId: string | null;
            variantId: string | null;
            orderId: string | null;
            position: number;
            description: string;
            quantity: number;
            unitPriceMinor: number;
            discountMinor: number;
            lineNetMinor: number;
            taxId: string | null;
            taxName: string | null;
            taxRateBps: number;
            taxInclusive: boolean;
            taxExempt: boolean;
            taxExemptReason: string | null;
            taxMinor: number;
            lineTotalMinor: number;
            meta: unknown;
        }[];
    }>;
    private formatInvoiceNumber;
    updateDraftInvoice(companyId: string, invoiceId: string, dto: any, audit?: {
        userId?: string;
        ip?: string;
    }, ctx?: {
        tx?: TxOrDb;
    }): Promise<any>;
    seedDefaultInvoiceSeriesForCompany(companyId: string): Promise<{
        created: boolean;
        id: string;
    }>;
}
export {};
